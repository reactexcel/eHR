(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{1174:function(e,t,a){"use strict";a.r(t);var n=a(26),s=a(27),r=a(29),o=a(28),l=a(30),c=a(13),i=a(0),d=a.n(i),m=a(36),u=a(566),p=a(10),f=a(45),_=a(129),h=a(37),b=a(24),v=a(133),y=a(262),E=a(269),O=a(71),j=a.n(O),g=a(704),N=a(107),L=a(130),k=a.n(L),w=function(e){function t(){var e;return Object(n.a)(this,t),(e=Object(r.a)(this,Object(o.a)(t).call(this))).state={},e}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return d.a.createElement(k.a,{title:"Upload Leave Document",modal:!1,open:this.props.open,onRequestClose:this.props.handleClose,contentClassName:"dialog-content",autoScrollBodyContent:!0},d.a.createElement("div",null,d.a.createElement("form",{method:"POST",encType:"multipart/form-data"},d.a.createElement("input",{type:"hidden",name:"token"}),d.a.createElement("input",{type:"hidden",name:"leaveid"}),d.a.createElement("input",{type:"hidden",name:"page_url"}),d.a.createElement("div",{className:"form-group"},d.a.createElement("label",null,"Attachment"),d.a.createElement("input",{type:"file",className:"form-control",ref:"file",name:"docProof"})),d.a.createElement("div",{className:"form-group"},d.a.createElement("input",{type:"submit",name:"submit",value:"Upload",className:"col-xs-12 md-btn md-raised indigo"})))))}}]),t}(d.a.Component),S=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).state={status_message:"",open:!1,id:"",form_from_date:"",form_to_date:"",form_no_of_days:"",form_reason:"",day_status:"",show_half_day_button:"",leaveType:"",late_reason:""},a.handleClose=a.handleClose.bind(Object(c.a)(Object(c.a)(a))),a.handleOpen=a.handleOpen.bind(Object(c.a)(Object(c.a)(a))),a.doApplyLeave=a.doApplyLeave.bind(Object(c.a)(Object(c.a)(a))),a.handleStartDate=a.handleStartDate.bind(Object(c.a)(Object(c.a)(a))),a.handleEndDate=a.handleEndDate.bind(Object(c.a)(Object(c.a)(a))),a._apply_half_day_1=a._apply_half_day_1.bind(Object(c.a)(Object(c.a)(a))),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(){window.scrollTo(0,0),""!=this.state.form_from_date&&""!=this.state.form_to_date&&""==this.state.form_no_of_days&&this.props.onDaysBetweenLeaves(this.state.form_from_date,this.state.form_to_date)}},{key:"handleClose",value:function(){this.setState({open:!1,status_message:""})}},{key:"handleOpen",value:function(){this.setState({status_message:"",open:!0})}},{key:"_apply_half_day_1",value:function(e){1==e?this.setState({form_no_of_days:"0.5",day_status:"1"}):2==e&&this.setState({form_no_of_days:"0.5",day_status:"2"})}},{key:"handleStartDate",value:function(e){var t=e.format("YYYY-MM-DD");this.setState({form_from_date:t,form_no_of_days:""})}},{key:"handleEndDate",value:function(e){var t=e.format("YYYY-MM-DD");this.setState({form_to_date:t,form_no_of_days:""})}},{key:"doApplyLeave",value:function(e){this.state.form_reason.length>30?1==this.props.forAdmin?(this.props.doApplyLeave(this.state.form_from_date,this.state.form_to_date,this.state.form_no_of_days,this.state.form_reason,this.props.selectedUserId,this.state.day_status,this.state.leaveType,this.state.late_reason),this.setState({form_from_date:"",form_to_date:"",form_no_of_days:"",form_reason:"",show_half_day_button:"",day_status:"",leaveType:"",late_reason:""})):(this.props.doApplyLeave(this.state.form_from_date,this.state.form_to_date,this.state.form_no_of_days,this.state.form_reason,"",this.state.day_status,this.state.leaveType,this.state.late_reason),this.setState({form_from_date:"",form_to_date:"",form_no_of_days:"",form_reason:"",show_half_day_button:"",day_status:"",leaveType:"",late_reason:""})):Object(f.b)("Warning","Explain your leave in detail, write atleast 2-3 lines","warning"),e.preventDefault()}},{key:"componentWillReceiveProps",value:function(e){var t="0";""!=e.applyLeave.count_working_days&&0!=e.applyLeave.count_working_days&&(t=e.applyLeave.count_working_days),this.setState({form_from_date:e.applyLeave.start_date,form_to_date:e.applyLeave.end_date,form_no_of_days:t})}},{key:"render",value:function(){var e=this,t=this.props.policyDocuments.data.map(function(e,t){if("Leave Policy"===e.name)return d.a.createElement("a",{key:t,href:e.link,target:"_blank"},d.a.createElement("label",{key:t,className:"pointer m-t-xs"},"Read Leave Policy"))}),a=j()(j()().format("YYYY-MM-DD")).diff(this.state.form_from_date||j()().format("YYYY-MM-DD"),"days"),n="",s="";1==this.state.form_no_of_days&&(n=d.a.createElement(N.b,{className:"text-accent",onClick:function(){return e._apply_half_day_1(1)},label:"Apply Leave For First Half"}),s=d.a.createElement(N.b,{className:"text-accent",onClick:function(){return e._apply_half_day_1(2)},label:"Apply Leave For Second Half"}));var r="63%";return 1==this.props.forAdmin&&(r="82%"),d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-xs-6 col-md-4 text-center calendar"},d.a.createElement("h6",null,"Select Start Date"),d.a.createElement(g.Calendar,{onChange:this.handleStartDate})),d.a.createElement("div",{className:"col-xs-6 col-md-4 text-center calendar"},d.a.createElement("h6",null,"Select End Date"),d.a.createElement(g.Calendar,{onChange:this.handleEndDate})),d.a.createElement("div",{className:"col-xs-12 col-md-4"},d.a.createElement("h5",null,"Leave Summary"),d.a.createElement("br",null),d.a.createElement("form",{role:"form",onSubmit:this.doApplyLeave},d.a.createElement("div",{className:"box-body"},d.a.createElement("div",{className:"streamline b-l m-l"},d.a.createElement("div",{className:"sl-item b-success"},d.a.createElement("div",{className:"sl-icon"},d.a.createElement("i",{className:"fa fa-check"})),d.a.createElement("div",{className:"sl-content"},d.a.createElement("div",{className:"sl-date text-muted"},"Your leave starts from"),d.a.createElement("div",null,this.state.form_from_date))),d.a.createElement("div",{className:"sl-item b-info"},d.a.createElement("div",{className:"sl-content"},d.a.createElement("div",{style:{width:r}},d.a.createElement("select",{value:this.state.leaveType,onChange:function(t){e.setState({leaveType:t.target.value})},className:"form-control",required:!0},d.a.createElement("option",{value:"",disabled:!0},"Select Option"),d.a.createElement("option",{value:"Casual Leave"}," Casual Leave "),d.a.createElement("option",{value:"Sick Leave"}," Sick Leave "),d.a.createElement("option",{value:"RH Compensation"}," RH Compensation "))))),d.a.createElement("div",{className:"sl-item b-info"},d.a.createElement("div",{className:"sl-content"},d.a.createElement("div",{className:"sl-date text-muted"},"No. of days"),d.a.createElement("div",null,this.state.form_no_of_days),d.a.createElement("div",null,n,s))),d.a.createElement("div",{className:"sl-item b-warning"},d.a.createElement("div",{className:"sl-content"},d.a.createElement("div",{className:"sl-date text-muted"},"Reason"),d.a.createElement("div",null,d.a.createElement("textarea",{ref:"reason",onChange:function(){return e.setState({form_reason:e.refs.reason.value})},value:this.state.form_reason})))),a>0?d.a.createElement("div",{className:"sl-item b-warning"},d.a.createElement("div",{className:"sl-content"},d.a.createElement("div",{className:"sl-date text-muted"},"Reason For Late Applying"),d.a.createElement("div",null,d.a.createElement("input",{type:"text",onChange:function(t){return e.setState({late_reason:t.target.value})},value:this.state.late_reason,required:!0})),d.a.createElement("div",{style:{marginTop:"10px",width:"63%",paddingLeft:"10px",background:"blanchedalmond"}},t))):null,d.a.createElement("div",{className:"sl-item b-success"},d.a.createElement("div",{className:"sl-icon"},d.a.createElement("i",{className:"fa fa-check red"})),d.a.createElement("div",{className:"sl-content"},d.a.createElement("div",{className:"sl-date text-muted"},"Your leave ends on"),d.a.createElement("div",null,this.state.form_to_date)),d.a.createElement("div",{className:"col-sm-12 ",style:{display:"inline-grid"}},d.a.createElement("small",null,"Send Document on Slack to Manish"),d.a.createElement("button",{type:"button",onClick:function(){return e.handleOpen()},className:"btn btn-info btn-responsive btn-res col-xs-2"},"Upload Leave Document"),d.a.createElement("small",{className:"uploadnotic"},"* Upload file size should be less than 1 MB"))),d.a.createElement(w,{handleClose:this.handleClose,open:this.state.open})),d.a.createElement("div",{className:"form-group row m-t-md"},d.a.createElement("div",{className:"col-xs-12 col-md-6 text-center"},d.a.createElement(N.a,{type:"submit",className:"green apply-leave-btn",label:"Apply"})))))))}}]),t}(d.a.Component),D=a(4),x=a(176),U=(a(104),a(643)),C=a(703),A=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(o.a)(t).call(this,e))).props.onIsAlreadyLogin(),a.state={defaultUserDisplay:"",selected_user_name:"",selected_user_image:"",selected_user_jobtitle:"",selected_user_id:"",show_status_message:!0},a.onUserClick=a.onUserClick.bind(Object(c.a)(Object(c.a)(a))),a.doApplyLeave=a.doApplyLeave.bind(Object(c.a)(Object(c.a)(a))),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.onFetchUserPolicyDocument()}},{key:"componentWillReceiveProps",value:function(e){window.scrollTo(0,0);var t=Object(h.e)(this.props.location.pathname,e.loggedUser);t.status&&this.props.history.push(t.redirectTo),e.loggedUser.data.role!==b.a.ADMIN&&e.loggedUser.data.role!==b.a.HR||""===this.state.defaultUserDisplay&&e.onUsersList()}},{key:"componentDidUpdate",value:function(){if((this.props.loggedUser.data.role===b.a.ADMIN||this.props.loggedUser.data.role===b.a.HR)&&""===this.state.defaultUserDisplay&&this.props.usersList.users.length>0){var e=this.props.usersList.users[0].user_Id;this.onUserClick(e)}}},{key:"onUserClick",value:function(e){var t="",a="",n="",s="";if(this.props.usersList.users.length>0){var r=p.find(this.props.usersList.users,{user_Id:e});"undefined"!==typeof r&&(t=r.name,a=r.slack_profile.image_192,n=r.jobtitle,s=r.user_Id)}this.setState({defaultUserDisplay:e,selected_user_name:t,selected_user_image:a,selected_user_jobtitle:n,selected_user_id:s,show_status_message:!1})}},{key:"doApplyLeave",value:function(e,t,a,n,s,r,o,l){this.setState({show_status_message:!0}),this.props.onApplyLeave(e,t,a,n,s,r,o,l).then(function(e){Object(f.b)("Success !",e,"success")}).catch(function(e){Object(f.b)("Error !",e,"error")})}},{key:"render",value:function(){var e="";""!==this.props.applyLeave.status_message&&!0===this.state.show_status_message&&(e=d.a.createElement("span",{className:"well",style:{background:"#60cffa",padding:"5px",marginLeft:"8px"}},this.props.applyLeave.status_message));var t=this.props.loggedUser.data.role===b.a.ADMIN||this.props.loggedUser.data.role===b.a.HR?d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-sm-3 hidden-xs",id:"fixedScroll"},d.a.createElement(v.a,{users:this.props.usersList.users,selectedUserId:this.state.selected_user_id,onUserClick:this.onUserClick,props:this.props,top:10})),d.a.createElement("div",{className:"col-xs-12 col-sm-9"},d.a.createElement("div",{className:"box"},d.a.createElement("div",{className:"p-a text-center"},d.a.createElement("a",{href:"",className:"text-md m-t block"},this.state.selected_user_name),d.a.createElement("p",null,d.a.createElement("small",null,this.state.selected_user_jobtitle)))),d.a.createElement("div",{className:"box"},d.a.createElement("div",{className:"box-body"},d.a.createElement(S,Object.assign({forAdmin:!0,doApplyLeave:this.doApplyLeave,selectedUserId:this.state.selected_user_id},this.props)))))):d.a.createElement("div",{className:"box"},d.a.createElement("div",{className:"box-body"},d.a.createElement(S,Object.assign({doApplyLeave:this.doApplyLeave,forAdmin:!1},this.props))));return d.a.createElement("div",null,d.a.createElement(_.a,this.props),d.a.createElement("div",{id:"content",className:"app-content box-shadow-z0",role:"main"},d.a.createElement(y.a,{pageTitle:"Apply Leave",status:e,showLoading:this.props.frontend.show_loading,userListHeader:!0}),d.a.createElement(E.a,{users:this.props.usersList.users,selectedUserId:this.state.selected_user_id,onUserClick:this.onUserClick}),d.a.createElement("div",{className:"app-body",id:"view"},d.a.createElement("div",{className:"padding p-t-lg"},t))))}}]),t}(d.a.Component);A.styles={height100per:{minHeight:"150px"}};var P=Object(m.b)(function(e){return{frontend:e.frontend.toJS(),loggedUser:e.logged_user.userLogin,usersList:e.usersList.toJS(),applyLeave:e.applyLeave.toJS(),policyDocuments:e.policyDocuments.policyDocument}},function(e){return{onIsAlreadyLogin:function(){return e(D.isAlreadyLogin())},onApplyLeave:function(t,a,n,s,r,o,l,c){return e(U.a(t,a,n,s,r,o,l,c))},onDaysBetweenLeaves:function(t,a){return e(U.b(t,a))},onUsersList:function(){return e(x.c())},onFetchUserPolicyDocument:function(){return e(D.requestUserPolicyDocument())},onDocRequired:function(t,a,n){return e(C.b(t,a,n))}}})(A),T=Object(u.a)(P);t.default=T},643:function(e,t,a){"use strict";a.d(t,"a",function(){return m}),a.d(t,"b",function(){return u});var n=a(5),s=a(10),r=(a(134),a(24),a(12)),o=a(1),l=a(33);function c(e){return Object(n.a)(o.nb)(e)}function i(e){return Object(n.a)(o.jb)("Leave Apply Fail")}function d(e){return Object(n.a)(o.ib)("Error Occurs !!")}function m(e,t,a,n,o,m,u,p,f,_,h){return function(_,h){return s.isEmpty(e)?Promise.reject("From date is empty"):s.isEmpty(t)?Promise.reject("To date is empty"):""==a?Promise.reject("No of days is empty"):s.isEmpty(n)?Promise.reject("Reason is empty"):new Promise(function(s,h){_(Object(l.b)()),""==o?function(e,t,a,n,s,o,l,c,i,d,m){return Object(r.b)("POST","",{action:"apply_leave",from_date:e,to_date:t,no_of_days:a,reason:n,day_status:s,leave_type:o,late_reason:l,pending_id:c})}(e,t,a,n,m,u,p,f).then(function(e){_(Object(l.a)()),0==e.error?(_(c(e.data.message)),s()):(_(i(e.data.message)),h(e.data.message))},function(e){_(Object(l.a)()),_(d())}):function(e,t,a,n,s,o,l,c,i,d,m){return Object(r.b)("POST","",{action:"admin_user_apply_leave",from_date:e,to_date:t,no_of_days:a,reason:n,user_id:s,day_status:o,leave_type:l,late_reason:c,pending_id:i})}(e,t,a,n,o,m,u,p,f).then(function(e){_(Object(l.a)()),0==e.error?(s(e.data.message),_(c(e.data.message))):(_(i(e.data.message)),h(e.data.message))},function(e){_(Object(l.a)()),_(d()),h("error occurs")})})}}function u(e,t){return function(a,s){return new Promise(function(s,c){a(Object(l.b)()),function(e,t){return Object(r.b)("POST","",{action:"get_days_between_leaves",start_date:e,end_date:t})}(e,t).then(function(e){var t;a(Object(l.a)()),0==e.error?a((t=e.data,Object(n.a)(o.c)(t))):a(function(e){return Object(n.a)(o.b)(e)}(e.data))},function(e){var t;a(Object(l.a)()),a((t="error occurs",Object(n.a)(o.a)(t)))})})}}},673:function(e,t,a){"use strict";a.d(t,"a",function(){return c});var n=a(5),s=(a(10),a(134),a(24),a(12)),r=a(1),o=a(33);function l(e){return Object(n.a)(r.pb)("Error Occurs !!")}function c(e){return function(e,t){return new Promise(function(t,a){e(Object(o.b)()),Object(s.b)("POST","",{action:"get_all_leaves"}).then(function(a){var s;e(Object(o.a)()),0==a.error?(e((s=a.data,Object(n.a)(r.qb)(s))),t()):e(l(a.data.message))},function(t){e(Object(o.a)()),e(l(t.data.message))})})}}},703:function(e,t,a){"use strict";a.d(t,"a",function(){return c}),a.d(t,"b",function(){return i}),a.d(t,"e",function(){return d}),a.d(t,"d",function(){return m}),a.d(t,"c",function(){return u});var n=a(5),s=(a(10),a(134),a(24),a(12)),r=a(1),o=a(33),l=a(673);function c(e,t,a){return function(c,i){return new Promise(function(i,d){c(Object(o.b)()),function(e,t,a){return Object(s.b)("POST","",{action:"change_leave_status",leaveid:e,newstatus:t,messagetouser:a})}(e,t,a).then(function(e){var t;c(Object(o.a)()),0==e.error?(c((t=e.data.message,Object(n.a)(r.mb)(t))),c(l.a())):c(function(e){return Object(n.a)(r.lb)(e)}(e.data.message))},function(e){var t;c(Object(o.a)()),c((t="error occurs",Object(n.a)(r.kb)(t)))})})}}function i(e,t,a){return function(n,r){return new Promise(function(r,c){n(Object(o.b)()),function(e,t,a){return Object(s.b)("POST","",{action:"send_request_for_doc",leaveid:e,doc_request:t,comment:a})}(e,t,a).then(function(e){n(Object(o.a)()),0==e.error&&n(l.a())},function(e){n(l.a()),n(Object(o.a)())})})}}function d(e,t,a){return function(n,r){return new Promise(function(r,c){n(Object(o.b)()),function(e,t,a){return Object(s.b)("POST","",{action:"add_extra_leave_day",leaveid:e,token:t,extra_day:a})}(e,t,a).then(function(e){n(Object(o.a)()),0==e.error&&n(l.a())},function(e){n(l.a()),n(Object(o.a)())})})}}function m(e,t,a){return function(n,r){return new Promise(function(r,c){n(Object(o.b)()),function(e,t,a){return Object(s.b)("POST","",{action:"add_hr_comment",leaveid:e,hr_comment:t,hr_approve:a})}(e,t,a).then(function(e){r(e.data.leaveid),n(Object(o.a)()),0==e.error&&n(l.a())},function(e){n(l.a()),n(Object(o.a)())})})}}function u(e,t){return function(a,n){return new Promise(function(n,r){a(Object(o.b)()),function(e,t){return Object(s.b)("POST","",{action:"revert_leave_status",leaveid:e,token:t})}(e,t).then(function(e){n(e),a(Object(o.a)()),0==e.error&&a(l.a())},function(e){a(l.a()),a(Object(o.a)())})})}}}}]);
//# sourceMappingURL=37.bca51000.chunk.js.map