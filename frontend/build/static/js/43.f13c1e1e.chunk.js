(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{1163:function(e,t,a){"use strict";a.r(t);var n=a(26),o=a(27),l=a(29),i=a(28),r=a(30),s=a(13),c=a(0),d=a.n(c),u=a(36),m=a(566),p=a(10),f=a.n(p),h=a(45),b=a(129),g=a(262),v=a(37),E=a(603),y=a(263),O=a.n(y),j=a(695),_=a.n(j),N=a(640),k=a.n(N),R=a(130),C=a.n(R),x=a(107),I=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(i.a)(t).call(this,e))).state={open:!1,baseRoleId:"",name:"",description:"",error:{baseRoleId:"",name:"",description:""}},a.handleOpen=a.handleOpen.bind(Object(s.a)(Object(s.a)(a))),a.handleClose=a.handleClose.bind(Object(s.a)(Object(s.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(s.a)(Object(s.a)(a))),a}return Object(r.a)(t,e),Object(o.a)(t,[{key:"handleOpen",value:function(){this.setState({open:!0,baseRoleId:"",name:"",description:""})}},{key:"handleClose",value:function(){this.setState({open:!1})}},{key:"handleSubmit",value:function(){var e=this.state,t=e.baseRoleId,a=e.name,n=e.description,o={baseRoleId:"",name:"",description:""},l=!0;f.a.isEmpty(a)&&(l=!1,o.name="This field is required."),f.a.isEmpty(n)&&(l=!1,o.description="This field is required."),this.setState({error:o}),l&&(this.props.callAddNewRole({baseRoleId:t,name:a,description:n}),this.handleClose())}},{key:"render",value:function(){var e=this,t=f.a.map(this.props.displayData.roles,function(e,t){return d.a.createElement("div",{id:"".concat(e.name,"_list"),key:t},d.a.createElement(k.a,{key:t,value:e.id,primaryText:e.name}))});return d.a.createElement("div",{className:"col-sm-12 p-y",id:"role_button"},d.a.createElement(x.a,{className:"btn-fw info",id:"add_role",onClick:this.handleOpen,label:"Add New Role"}),d.a.createElement(C.a,{id:"add_role_dialog",title:"Add Role",modal:!1,open:this.state.open,onRequestClose:this.handleClose,contentClassName:"dialog-add-role",autoScrollBodyContent:!0},d.a.createElement("br",null),d.a.createElement(_.a,{fullWidth:!0,id:"role_selector",value:this.state.baseRoleId,onChange:function(t,a,n){e.setState({baseRoleId:n})}},d.a.createElement(k.a,{value:"",primaryText:" Select Base Role "}),d.a.createElement("div",{id:"role_list"},t)),d.a.createElement(O.a,{id:"role_name",floatingLabelText:"Name",floatingLabelFixed:!0,fullWidth:!0,onChange:function(t){return e.setState({name:t.target.value})},value:this.state.name,errorText:this.state.error.name}),d.a.createElement(O.a,{id:"role_desc",floatingLabelText:"Description",floatingLabelFixed:!0,fullWidth:!0,onChange:function(t){return e.setState({description:t.target.value})},value:this.state.description,errorText:this.state.error.description}),d.a.createElement(x.c,{className:"col-md-12 m-y-sm indigo",id:"role_submit_button",onClick:function(){return e.handleSubmit()},label:"Submit New Role"})))}}]),t}(d.a.Component),w=a(565),D=function(e){var t=e.displayData,a=e.handleChange,n=e.handleChangeNotification,o=e.handleDelete,l=t.roles,i=f.a.map(l,function(e,t){var l=e.id,i=f.a.map(e.role_pages,function(e,t){var n=e.id,o=f.a.map(e.actions_list,function(e,t){var n=e.id;return d.a.createElement("li",{key:t},d.a.createElement("input",{type:"checkbox",id:"check_"+e.name,value:e.name,checked:e.is_assigned,onChange:function(e){a(e,n,l)},key:n})," ",e.name)});return d.a.createElement("li",{key:t},d.a.createElement("input",{type:"checkbox",id:"check_"+e.name,value:e.name,checked:e.is_assigned,onChange:function(e){a(e,n,l)},key:n})," ",e.name,d.a.createElement("ul",{className:"m-b-xs m-l-md"},o))}),r=f.a.map(e.role_notifications,function(e,t){var a=e.id;return d.a.createElement("div",{key:t},d.a.createElement("input",{type:"checkbox",value:e.name,checked:e.is_assigned,onChange:function(){n(a,l)},key:a})," ",e.name,d.a.createElement("br",null))}),s="coll"+l;return d.a.createElement("div",{className:"panel panel-default",id:"".concat(e.name,"_body"),style:{border:0},key:t},d.a.createElement("div",{className:"panel-heading p-b-lg"},d.a.createElement("div",{className:"panel-title p-b-md"},d.a.createElement("span",{className:"col-xs-8 col-sm-9"},d.a.createElement(w.a,{"data-toggle":"collapse","data-parent":"#accordion",to:"#".concat(s)},d.a.createElement("h4",{className:"m-b-xs text-lg col-xs-10",id:"".concat(e.name,"_span")},e.name),d.a.createElement("span",{className:"col-xs-12 text-sm"},e.description))),d.a.createElement(w.a,{to:"/manage_roles",id:"".concat(e.name,"_delete"),className:"col-xs-4 col-sm-3 m-t-sm p-t-sm text-sm text-danger",onClick:function(){Object(h.a)("Are you sure ?","Do you want to Delete the Role ?","warning").then(function(e){e&&o(l)})}},d.a.createElement("i",null,"Delete Role")))),d.a.createElement("div",{id:s,className:"table-responsive panel-collapse collapse"},d.a.createElement("div",{className:"navside panel-body p-a-xs"},d.a.createElement("table",{className:"table table-condensed"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,"Pages - Actions"),d.a.createElement("th",null," Notification "))),d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",null,d.a.createElement("ul",null,i)),d.a.createElement("td",null,r)))))))});return d.a.createElement("div",{className:"row box p-t"},d.a.createElement("div",{className:"col-xs-12 panel-group",id:"accordion"},i))},S=a(111),A=a.n(S),P=function(e){var t=e.users,a=e.onChange,n="";if(void 0!==t.users_list){var o=t.users_list.data,l=t.roles;n=f.a.map(o,function(e,t){var n="",o="",i=e.user_Id,r=e.role_name,s=d.a.createElement("span",{className:"text-success text-sm",id:"".concat(t,"_span")},d.a.createElement("b",null,"Role")," : ",r," "," ",d.a.createElement("span",{onClick:function(){a(i,"0")},className:"glyphicon glyphicon-remove text-danger",title:"Remove Role"}));null!==r&&0!==r||(s=d.a.createElement("span",{className:"text-danger text-sm"},d.a.createElement("b",null,"Role")," : -- ")),f.a.isEmpty(e.slack_profile)?(o=null!=e.name?e.name.charAt(0):"",n=d.a.createElement(A.a,null,o)):(o=e.slack_profile.image_72,n=d.a.createElement("img",{src:o}));var c=f.a.map(l,function(e,t){return d.a.createElement("option",{key:t,id:"".concat(e.name,"_val"),value:e.id},e.name)}),u=d.a.createElement("select",{key:i,name:i,id:"".concat(t,"_change"),onChange:function(e){a(i,e.target.value)},className:"form-control text-muted text-ellipsis"},d.a.createElement("option",{value:"-1"}," CHANGE ROLE "),c);return d.a.createElement("div",{className:"b-x p-a-sm pointer",id:"".concat(t,"_list"),key:t},d.a.createElement("div",{className:"list-left"},d.a.createElement("span",{className:"w-40 avatar"},n)),d.a.createElement("div",{className:"list-body"},d.a.createElement("span",null,e.name),d.a.createElement("small",{className:"text-muted text-ellipsis"},e.jobtitle),s,u))})}return d.a.createElement("div",{className:"box responsive-p-x-sm p-y clear fixed-height",id:"user_list"},n)},L=a(4),T=a(5),U=a(12),J=a(33),W=a(1);function q(e){return Object(T.a)(W.s)(e)}function B(e){return function(t,a){var n=e.baseRoleId,o="",l="";return"undefined"===typeof e.name||""==e.name?Promise.reject("Name is empty"):(o=e.name,"undefined"===typeof e.description||""==e.description?Promise.reject("Description is empty"):(l=e.description,new Promise(function(e,a){t(Object(J.b)()),function(e,t,a){return Object(U.b)("POST","",{action:"add_roles",base_role_id:e,name:t,description:a})}(n,o,l).then(function(e){var a;t(Object(J.a)()),0==e.error?(t((a=e.message,Object(T.a)(W.Gb)(a))),t(F())):t(q(e.message))},function(e){t(Object(J.a)()),t(q("error occurs!!!")),a("error occurs!!!")})})))}}function F(){return function(e,t){return new Promise(function(t,a){e(Object(J.b)()),Object(U.b)("POST","",{action:"list_all_roles"}).then(function(t){var a;e(Object(J.a)()),0==t.error?e((a=t.data,Object(T.a)(W.ic)(a))):e(function(e){return Object(T.a)(W.g)(e)}([]))},function(t){var a;e(Object(J.a)()),e((a=[],Object(T.a)(W.N)(a)))})})}}function G(e){return Object(T.a)(W.X)(e)}function H(e){return function(t,a){var n="",o="",l="",i="";return"undefined"!==typeof e.notificationId&&(i=e.notificationId),"undefined"!==typeof e.rolesId&&(n=e.rolesId),"undefined"!==typeof e.actionId&&(o=e.actionId),"undefined"!==typeof e.pageId&&(l=e.pageId),""===n.trim()?Promise.reject("User id is empty"):new Promise(function(){t(Object(J.b)()),function(e,t,a,n){return Object(U.b)("POST","",{action:"update_role",role_id:t,page_id:n,action_id:a,notification_id:e})}(i,n,o,l).then(function(e){var a;t(Object(J.a)()),0==e.error?(t(F()),t((a=e.message,Object(T.a)(W.tc)(a)))):t(G(e.message))},function(e){t(Object(J.a)()),t(G("error occurs!!!"))})})}}function M(e){return Object(T.a)(W.ab)(e)}function z(e){return function(t,a){var n="",o="";return"undefined"!==typeof e.roleId&&(n=e.roleId),"undefined"!==typeof e.userId&&(o=e.userId),""===n.trim()?null:""===o.trim()?Promise.reject("User id is empty"):new Promise(function(){t(Object(J.b)()),function(e,t){return Object(U.b)("POST","",{action:"assign_user_role",user_id:e,role_id:t})}(o,n).then(function(e){var a;t(Object(J.a)()),0==e.error?t((a=e.message,Object(T.a)(W.wc)(a))):t(M(e.message))},function(e){t(Object(J.a)()),t(M("error occurs!!!"))})})}}function X(e){return function(t,a){return"undefined"===typeof e||""==e?Promise.reject("Delete Id is empty"):new Promise(function(a,n){t(Object(J.b)()),function(e){return Object(U.b)("POST","",{action:"delete_role",role_id:e})}(e).then(function(e){t(Object(J.a)()),0==e.error?(a(e.message),t(F())):n(e.message)},function(e){t(Object(J.a)()),n("error occurs!!!")})})}}var K=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(i.a)(t).call(this,e))).props.onIsAlreadyLogin(),a.state={status_message:"",rolesData:[],updateRole:{rolesId:"",actionId:"",pageId:"",notificationId:""}},a.callAddNewRole=a.callAddNewRole.bind(Object(s.a)(Object(s.a)(a))),a.handleChangeNotification=a.handleChangeNotification.bind(Object(s.a)(Object(s.a)(a))),a.onUserClick=a.onUserClick.bind(Object(s.a)(Object(s.a)(a))),a.handleChange=a.handleChange.bind(Object(s.a)(Object(s.a)(a))),a}return Object(r.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.props.onRolesList()}},{key:"componentWillReceiveProps",value:function(e){var t=e.loggedUser,a=e.location,n=e.history,o=e.manageRoles.rolesData,l=Object(v.e)(a.pathname,t);l.status&&n.push(l.redirectTo),o!==this.state.rolesData&&this.setState({rolesData:o})}},{key:"callAddNewRole",value:function(e){this.props.onAddNewRole(e)}},{key:"handleChangeNotification",value:function(e,t){var a=this.state.updateRole;a.rolesId=t,a.notificationId=e,this.props.onUpdateRole(a)}},{key:"onUserClick",value:function(e,t){var a={userId:e,roleId:t};"-1"!==t&&(this.props.onUpdateUserRole(a),this.props.onRolesList())}},{key:"handleDelete",value:function(e){this.props.onDelete(e).then(function(e){Object(h.b)("Success!",e,"success")},function(e){Object(h.b)("Error!",e,"error")})}},{key:"handleChange",value:function(e,t,a){var n=this.state.rolesData,o=f.a.clone(this.state.updateRole);f.a.map(n.roles,function(n,l){n.id===a&&f.a.map(n.role_pages,function(a,n){a.id===t?(a.is_assigned=e.target.checked,o.pageId=t,f.a.map(a.actions_list,function(t,a){t.is_assigned=e.target.checked})):f.a.map(a.actions_list,function(a,n){a.id===t&&(a.is_assigned=e.target.checked,o.actionId=t)})})}),o.rolesId=a,this.setState({rolesData:n}),this.props.onUpdateRole(o)}},{key:"render",value:function(){var e=this;return d.a.createElement("div",null,d.a.createElement(b.a,this.props),d.a.createElement(E.a,{message:this.props.manageRoles.status_message}),d.a.createElement("div",{id:"content",className:"app-content box-shadow-z0",role:"main"},d.a.createElement(g.a,{pageTitle:"Manage Roles",showLoading:this.props.frontend.show_loading}),d.a.createElement("div",{className:"app-body",id:"view"},d.a.createElement("div",{className:"padding"},d.a.createElement("div",{className:"row"},d.a.createElement(I,{callAddNewRole:this.callAddNewRole,displayData:this.state.rolesData})),d.a.createElement("div",{className:"row",id:"role_page"},d.a.createElement("div",{className:"col-sm-8"},d.a.createElement(D,{displayData:this.state.rolesData,handleClick:function(t){return e.click(t)},handleChange:this.handleChange,handleChangeNotification:function(t,a){return e.handleChangeNotification(t,a)},handleDelete:function(t){e.handleDelete(t),e.setState({deleteId:t})}})),d.a.createElement("div",{className:"col-sm-4"},d.a.createElement(P,{users:this.state.rolesData,onChange:function(t,a){e.onUserClick(t,a)}})))))))}}]),t}(d.a.Component);var Q=Object(u.b)(function(e){return{frontend:e.frontend.toJS(),loggedUser:e.logged_user.userLogin,usersList:e.usersList.toJS(),manageRoles:e.manageRoles.toJS()}},function(e){return{onIsAlreadyLogin:function(){return e(L.isAlreadyLogin())},onAddNewRole:function(t){return e(B(t))},onRolesList:function(){return e(F())},onUpdateRole:function(t){return e(H(t))},onUpdateUserRole:function(t){return e(z(t))},onDelete:function(t){return e(X(t))}}})(K),V=Object(m.a)(Q);t.default=V},603:function(e,t,a){"use strict";var n=a(0),o=a.n(n),l=a(10),i=a.n(l),r=a(600),s=a.n(r);t.a=function(e){var t=e.message,a=(e.handleRequestClose,!1),n="";return i.a.isEmpty(t)||(a=!0,n=t),o.a.createElement(s.a,{open:a,message:n,autoHideDuration:4e3})}}}]);
//# sourceMappingURL=43.f13c1e1e.chunk.js.map