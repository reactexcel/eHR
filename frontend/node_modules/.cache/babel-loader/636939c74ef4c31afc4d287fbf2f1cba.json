{"ast":null,"code":"import * as _ from 'lodash';\nimport { createAction } from 'redux-actions';\nimport { CONFIG } from '../../../config/index';\nimport { fireAjax } from '../../../services/index';\nimport * as constants from '../../../redux/constants';\nimport { show_loading, hide_loading } from '../../../redux/generic/actions/frontend';\nimport 'whatwg-fetch'; // --------add new valiable-------\n\nexport function success_add_variable(data) {\n  return createAction(constants.ACTION_SUCCESS_ADD_VARIABLE)(data);\n}\nexport function error_add_varaible(data) {\n  return createAction(constants.ACTION_ERROR_ADD_VARIABLE)(data);\n}\n\nfunction async_saveVariable(id, variable) {\n  return fireAjax('POST', '', {\n    action: 'create_template_variable',\n    name: variable.varCode,\n    value: variable.varValue,\n    variable_type: variable.varType\n  });\n}\n\nfunction async_editVariable(id, variable) {\n  return fireAjax('POST', '', {\n    action: 'update_template_variable',\n    id: id,\n    name: variable.varCode,\n    value: variable.varValue,\n    variable_type: variable.varType\n  });\n}\n\nexport function saveVariable(id, variable) {\n  return function (dispatch, getState) {\n    return new Promise(function (resolve, reject) {\n      dispatch(show_loading());\n\n      if (id == '') {\n        async_saveVariable(id, variable).then(function (json) {\n          dispatch(hide_loading()); // hide loading icon\n\n          if (json.error == 0) {\n            dispatch(success_add_variable(json.data));\n            dispatch(get_variable());\n            resolve(json.data);\n          } else {\n            dispatch(error_add_varaible(json.error[0]));\n          }\n        }, function (error) {\n          dispatch(hide_loading()); // hide loading icon\n\n          dispatch(error_add_varaible('error occurs'));\n        });\n      } else {\n        async_editVariable(id, variable).then(function (json) {\n          dispatch(hide_loading()); // hide loading icon\n\n          if (json.error == 0) {\n            dispatch(success_add_variable(json.data));\n            dispatch(get_variable());\n            resolve(json.data);\n          } else {\n            dispatch(error_add_varaible(json.error[0]));\n          }\n        }, function (error) {\n          dispatch(hide_loading()); // hide loading icon\n\n          dispatch(error_add_varaible('error occurs'));\n        });\n      }\n    });\n  };\n} // ------------Get valiables---------\n\nfunction async_get_variable() {\n  return fireAjax('POST', '', {\n    action: 'get_template_variable'\n  });\n}\n\nexport function success_variable_get(data) {\n  return createAction(constants.ACTION_SUCCESS_VARIABLE_GET)(data);\n}\nexport function get_variable() {\n  return function (dispatch, getState) {\n    return new Promise(function (resolve, reject) {\n      dispatch(show_loading()); // show loading icon\n\n      async_get_variable().then(function (json) {\n        dispatch(hide_loading());\n\n        if (typeof json !== 'undefined' && json.length > 0) {\n          var data = json;\n          dispatch(success_variable_get(data));\n          resolve(data);\n        } else {\n          dispatch(success_variable_get([]));\n        }\n      }, function (error) {\n        dispatch(hide_loading()); // hide loading icon\n\n        dispatch(success_variable_get([]));\n      });\n    });\n  };\n} // ----------delete Variables---------------\n\nfunction async_delete_variable(id) {\n  return fireAjax('POST', '', {\n    action: 'delete_template_variable',\n    id: id\n  });\n}\n\nexport function deleteVariable(id) {\n  return function (dispatch, getState) {\n    return new Promise(function (resolve, reject) {\n      dispatch(show_loading()); // show loading icon\n\n      async_delete_variable(id).then(function (json) {\n        dispatch(hide_loading()); // hide loading icon\n\n        if (json.error == 0) {\n          dispatch(get_variable());\n          resolve(json.data.message);\n        } else {\n          dispatch(get_variable());\n          resolve(json.data.message);\n        }\n      }, function (error) {\n        dispatch(hide_loading()); // hide loading icon\n\n        reject('error occurs!!');\n      });\n    });\n  };\n} // ----------------get templates -------------\n\nexport function success_get_template(data) {\n  return createAction(constants.ACTION_SUCCESS_GET_TEMPLATES)(data);\n}\n\nfunction async_get_templates() {\n  return fireAjax('POST', '', {\n    action: 'get_email_template'\n  });\n}\n\nexport function get_templates() {\n  return function (dispatch, getState) {\n    return new Promise(function (resolve, reject) {\n      dispatch(show_loading());\n      async_get_templates().then(function (json) {\n        dispatch(hide_loading());\n\n        if (typeof json !== 'undefined' && json.length > 0) {\n          var data = json;\n          dispatch(success_get_template(data));\n          resolve(data);\n        } else {\n          dispatch(success_get_template([]));\n        }\n      }, function (error) {\n        dispatch(hide_loading()); // hide loading icon\n\n        reject('error occurs!!');\n      });\n    });\n  };\n} // -------------------save template ------------\n\nfunction async_save_template(t_name, t_subject, t_body) {\n  return fireAjax('POST', '', {\n    action: 'create_email_template',\n    name: t_name,\n    subject: t_subject,\n    body: t_body\n  });\n}\n\nfunction async_update_template(t_id, t_name, t_subject, t_body) {\n  return fireAjax('POST', '', {\n    action: 'update_email_template',\n    id: t_id,\n    name: t_name,\n    subject: t_subject,\n    body: t_body\n  });\n}\n\nexport function save_templates(t_id, t_name, t_subject, t_body) {\n  return function (dispatch, getState) {\n    return new Promise(function (resolve, reject) {\n      dispatch(show_loading());\n\n      if (_.isEmpty(t_id)) {\n        async_save_template(t_name, t_subject, t_body).then(function (json) {\n          dispatch(hide_loading());\n          dispatch(get_templates());\n          resolve(json.data.message);\n        }, function (error) {\n          dispatch(hide_loading()); // hide loading icon\n\n          reject('error occurs!!');\n        });\n      } else {\n        async_update_template(t_id, t_name, t_subject, t_body).then(function (json) {\n          dispatch(hide_loading());\n          dispatch(get_templates());\n          resolve(json.data.message);\n        }, function (error) {\n          dispatch(hide_loading()); // hide loading icon\n\n          reject('error occurs!!');\n        });\n      }\n    });\n  };\n} // --------------Delete template-------------\n\nfunction async_delete_template(t_id) {\n  return fireAjax('POST', '', {\n    action: 'delete_email_template',\n    id: t_id\n  });\n}\n\nexport function delete_template(t_id) {\n  return function (dispatch, getState) {\n    return new Promise(function (resolve, reject) {\n      dispatch(show_loading());\n      async_delete_template(t_id).then(function (json) {\n        dispatch(hide_loading());\n\n        if (json.error) {\n          reject(json.data.message);\n        } else {\n          dispatch(get_templates());\n          resolve();\n        }\n      }, function (error) {\n        dispatch(hide_loading());\n        reject('error occurs!!');\n      });\n    });\n  };\n} // ------------send_mail functionality------------\n\nfunction async_send_mail(email) {\n  return fireAjax('POST', '', {\n    action: 'send_employee_email',\n    email: email\n  });\n}\n\nexport function send_mail(email) {\n  return function (dispatch, getState) {\n    return new Promise(function (resolve, reject) {\n      dispatch(show_loading());\n      async_send_mail(email).then(function (json) {\n        dispatch(hide_loading());\n\n        if (json.error) {\n          reject(json.data.message);\n        } else {\n          dispatch(get_templates());\n          resolve(json.data.message);\n        }\n      }, function (error) {\n        dispatch(hide_loading());\n        reject('error occurs!!');\n      });\n    });\n  };\n} // -------------------Download PDF ------------\n\nfunction async_download_template(template, fileName) {\n  return fireAjax('POST', '', {\n    action: 'create_pdf',\n    template: template,\n    file_name: fileName\n  });\n}\n\nexport function download_pdf(template, fileName) {\n  return function (dispatch, getState) {\n    return new Promise(function (resolve, reject) {\n      dispatch(show_loading());\n      async_download_template(template, fileName).then(function (json) {\n        dispatch(hide_loading());\n        resolve(json.data);\n      }, function (error) {\n        dispatch(hide_loading());\n        reject('error occurs!!');\n      });\n    });\n  };\n}\n/* export function fetchVariable(){\n\treturn (dispatch,getState)=>{\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tMeteor.call('fetchAllVariable',(err,data)=>{\n\t\t\t\tif(err){\n\t\t\t\t\treject(err)\n\t\t\t\t}else{\n\t\t\t\t\tif(data.length > 0){\n\t\t\t\t\t\tdispatch(success_fetch_variable(data))\n\t\t\t\t\t\tresolve('variable loading completed')\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdispatch(success_fetch_variable(data))\n\t\t\t\t\t\tresolve('No variable in database')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n}\n\nexport function deleteVariable( id ){\n\treturn (dispatch,getState) => {\n\t\treturn new Promise( (resolve,reject) => {\n\t\t\tMeteor.call('deleteVariable', id , (err, data) => {\n\t\t\t\tif(err){\n\t\t\t\t\treject(err)\n\t\t\t\t}else{\n\t\t\t\t\tdispatch ( fetchVariable(data) )\n\t\t\t\t\tresolve(data)\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n}\n\nexport function success_fetch_variable( data ){\n\treturn createAction( ACTION_SUCCESS_FETCH_VARIABLE )( data )\n}*/","map":{"version":3,"sources":["/var/www/html/ReactReduxHR/frontend/src/redux/templates/actions/templates.js"],"names":["_","createAction","CONFIG","fireAjax","constants","show_loading","hide_loading","success_add_variable","data","ACTION_SUCCESS_ADD_VARIABLE","error_add_varaible","ACTION_ERROR_ADD_VARIABLE","async_saveVariable","id","variable","action","name","varCode","value","varValue","variable_type","varType","async_editVariable","saveVariable","dispatch","getState","Promise","resolve","reject","then","json","error","get_variable","async_get_variable","success_variable_get","ACTION_SUCCESS_VARIABLE_GET","length","async_delete_variable","deleteVariable","message","success_get_template","ACTION_SUCCESS_GET_TEMPLATES","async_get_templates","get_templates","async_save_template","t_name","t_subject","t_body","subject","body","async_update_template","t_id","save_templates","isEmpty","async_delete_template","delete_template","async_send_mail","email","send_mail","async_download_template","template","fileName","file_name","download_pdf"],"mappings":"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","sourcesContent":["import * as _ from 'lodash';\nimport {createAction} from 'redux-actions';\nimport {CONFIG} from '../../../config/index';\nimport {fireAjax} from '../../../services/index';\nimport * as constants from '../../../redux/constants';\nimport {show_loading, hide_loading} from '../../../redux/generic/actions/frontend';\nimport 'whatwg-fetch';\n\n// --------add new valiable-------\n\nexport function success_add_variable (data) {\n  return createAction(constants.ACTION_SUCCESS_ADD_VARIABLE)(data);\n}\nexport function error_add_varaible (data) {\n  return createAction(constants.ACTION_ERROR_ADD_VARIABLE)(data);\n}\n\nfunction async_saveVariable (id, variable) {\n  return fireAjax('POST', '', {\n    action:        'create_template_variable',\n    name:          variable.varCode,\n    value:         variable.varValue,\n    variable_type: variable.varType\n  });\n}\n\nfunction async_editVariable (id, variable) {\n  return fireAjax('POST', '', {\n    action:        'update_template_variable',\n    id:            id,\n    name:          variable.varCode,\n    value:         variable.varValue,\n    variable_type: variable.varType\n  });\n}\n\nexport function saveVariable (id, variable) {\n  return (dispatch, getState) => {\n    return new Promise((resolve, reject) => {\n      dispatch(show_loading());\n      if (id == '') {\n        async_saveVariable(id, variable).then((json) => {\n          dispatch(hide_loading()); // hide loading icon\n          if (json.error == 0) {\n            dispatch(success_add_variable(json.data));\n            dispatch(get_variable());\n            resolve(json.data);\n          } else {\n            dispatch(error_add_varaible(json.error[0]));\n          }\n        },\n        (error) => {\n          dispatch(hide_loading()); // hide loading icon\n          dispatch(error_add_varaible('error occurs'));\n        }\n);\n      } else {\n        async_editVariable(id, variable).then((json) => {\n          dispatch(hide_loading()); // hide loading icon\n          if (json.error == 0) {\n            dispatch(success_add_variable(json.data));\n            dispatch(get_variable());\n            resolve(json.data);\n          } else {\n            dispatch(error_add_varaible(json.error[0]));\n          }\n        },\n          (error) => {\n            dispatch(hide_loading()); // hide loading icon\n            dispatch(error_add_varaible('error occurs'));\n          }\n        );\n      }\n    });\n  };\n}\n\n// ------------Get valiables---------\n\nfunction async_get_variable () {\n  return fireAjax('POST', '', {\n    action: 'get_template_variable'\n  });\n}\n\nexport function success_variable_get (data) {\n  return createAction(constants.ACTION_SUCCESS_VARIABLE_GET)(data);\n}\n\nexport function get_variable () {\n  return function (dispatch, getState) {\n    return new Promise((resolve, reject) => {\n      dispatch(show_loading()); // show loading icon\n      async_get_variable().then((json) => {\n        dispatch(hide_loading());\n        if (typeof json !== 'undefined' && json.length > 0) {\n          let data = json;\n          dispatch(success_variable_get(data));\n          resolve(data);\n        } else {\n          dispatch(success_variable_get([]));\n        }\n      }, (error) => {\n        dispatch(hide_loading());// hide loading icon\n        dispatch(success_variable_get([]));\n      }\n\t\t\t);\n    });\n  };\n}\n\n// ----------delete Variables---------------\n\nfunction async_delete_variable (id) {\n  return fireAjax('POST', '', {\n    action: 'delete_template_variable',\n    id:     id\n  });\n}\n\nexport function deleteVariable (id) {\n  return function (dispatch, getState) {\n    return new Promise((resolve, reject) => {\n      dispatch(show_loading()); // show loading icon\n      async_delete_variable(id).then((json) => {\n        dispatch(hide_loading()); // hide loading icon\n        if (json.error == 0) {\n          dispatch(get_variable());\n          resolve(json.data.message);\n        } else {\n          dispatch(get_variable());\n          resolve(json.data.message);\n        }\n      }, (error) => {\n        dispatch(hide_loading());// hide loading icon\n        reject('error occurs!!');\n      }\n\t\t\t);\n    });\n  };\n}\n\n// ----------------get templates -------------\n\nexport function success_get_template (data) {\n  return createAction(constants.ACTION_SUCCESS_GET_TEMPLATES)(data);\n}\n\nfunction async_get_templates () {\n  return fireAjax('POST', '', {\n    action: 'get_email_template'\n  });\n}\nexport function get_templates () {\n  return function (dispatch, getState) {\n    return new Promise((resolve, reject) => {\n      dispatch(show_loading());\n      async_get_templates().then((json) => {\n        dispatch(hide_loading());\n        if (typeof json !== 'undefined' && json.length > 0) {\n          let data = json;\n          dispatch(success_get_template(data));\n          resolve(data);\n        } else {\n          dispatch(success_get_template([]));\n        }\n      }, (error) => {\n        dispatch(hide_loading()); // hide loading icon\n        reject('error occurs!!');\n      }\n\t\t\t);\n    });\n  };\n}\n\n// -------------------save template ------------\n\nfunction async_save_template (t_name, t_subject, t_body) {\n  return fireAjax('POST', '', {\n    action:  'create_email_template',\n    name:    t_name,\n    subject: t_subject,\n    body:    t_body\n  });\n}\nfunction async_update_template (t_id, t_name, t_subject, t_body) {\n  return fireAjax('POST', '', {\n    action:  'update_email_template',\n    id:      t_id,\n    name:    t_name,\n    subject: t_subject,\n    body:    t_body\n  });\n}\nexport function save_templates (t_id, t_name, t_subject, t_body) {\n  return function (dispatch, getState) {\n    return new Promise((resolve, reject) => {\n      dispatch(show_loading());\n      if (_.isEmpty(t_id)) {\n        async_save_template(t_name, t_subject, t_body).then((json) => {\n          dispatch(hide_loading());\n          dispatch(get_templates());\n          resolve(json.data.message);\n        },\n\t\t\t\t\t(error) => {\n  dispatch(hide_loading()); // hide loading icon\n  reject('error occurs!!');\n});\n      } else {\n        async_update_template(t_id, t_name, t_subject, t_body).then((json) => {\n          dispatch(hide_loading());\n          dispatch(get_templates());\n          resolve(json.data.message);\n        }, (error) => {\n          dispatch(hide_loading()); // hide loading icon\n          reject('error occurs!!');\n        }\n\t\t\t\t);\n      }\n    });\n  };\n}\n\n// --------------Delete template-------------\n\nfunction async_delete_template (t_id) {\n  return fireAjax('POST', '', {\n    action: 'delete_email_template',\n    id:     t_id\n  });\n}\n\nexport function delete_template (t_id) {\n  return function (dispatch, getState) {\n    return new Promise((resolve, reject) => {\n      dispatch(show_loading());\n      async_delete_template(t_id).then((json) => {\n        dispatch(hide_loading());\n        if (json.error) {\n          reject(json.data.message);\n        } else {\n          dispatch(get_templates());\n          resolve();\n        }\n      }, (error) => {\n        dispatch(hide_loading());\n        reject('error occurs!!');\n      }\n\t\t\t);\n    });\n  };\n}\n\n// ------------send_mail functionality------------\n\nfunction async_send_mail (email) {\n  return fireAjax('POST', '', {\n    action: 'send_employee_email',\n    email:  email\n  });\n}\n\nexport function send_mail (email) {\n  return function (dispatch, getState) {\n    return new Promise((resolve, reject) => {\n      dispatch(show_loading());\n      async_send_mail(email).then((json) => {\n        dispatch(hide_loading());\n        if (json.error) {\n          reject(json.data.message);\n        } else {\n          dispatch(get_templates());\n          resolve(json.data.message);\n        }\n      }, (error) => {\n        dispatch(hide_loading());\n        reject('error occurs!!');\n      }\n\t\t\t);\n    });\n  };\n}\n\n// -------------------Download PDF ------------\n\nfunction async_download_template (template, fileName) {\n  return fireAjax('POST', '', {\n    action:    'create_pdf',\n    template:  template,\n    file_name: fileName\n  });\n}\nexport function download_pdf (template, fileName) {\n  return function (dispatch, getState) {\n    return new Promise((resolve, reject) => {\n      dispatch(show_loading());\n      async_download_template(template, fileName).then((json) => {\n        dispatch(hide_loading());\n        resolve(json.data);\n      }, (error) => {\n        dispatch(hide_loading());\n        reject('error occurs!!');\n      }\n\t\t\t\t);\n    });\n  };\n}\n\n/* export function fetchVariable(){\n\treturn (dispatch,getState)=>{\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tMeteor.call('fetchAllVariable',(err,data)=>{\n\t\t\t\tif(err){\n\t\t\t\t\treject(err)\n\t\t\t\t}else{\n\t\t\t\t\tif(data.length > 0){\n\t\t\t\t\t\tdispatch(success_fetch_variable(data))\n\t\t\t\t\t\tresolve('variable loading completed')\n\t\t\t\t\t}else{\n\t\t\t\t\t\tdispatch(success_fetch_variable(data))\n\t\t\t\t\t\tresolve('No variable in database')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n}\n\nexport function deleteVariable( id ){\n\treturn (dispatch,getState) => {\n\t\treturn new Promise( (resolve,reject) => {\n\t\t\tMeteor.call('deleteVariable', id , (err, data) => {\n\t\t\t\tif(err){\n\t\t\t\t\treject(err)\n\t\t\t\t}else{\n\t\t\t\t\tdispatch ( fetchVariable(data) )\n\t\t\t\t\tresolve(data)\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n}\n\nexport function success_fetch_variable( data ){\n\treturn createAction( ACTION_SUCCESS_FETCH_VARIABLE )( data )\n}*/\n"]},"metadata":{},"sourceType":"module"}