{"ast":null,"code":"import _classCallCheck from \"/var/www/html/ReactReduxHR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/var/www/html/ReactReduxHR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/var/www/html/ReactReduxHR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/var/www/html/ReactReduxHR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/var/www/html/ReactReduxHR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/var/www/html/ReactReduxHR/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/var/www/html/ReactReduxHR/frontend/src/modules/leave/containers/manageLeaves.jsx\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router\";\nimport * as _ from \"lodash\";\nimport Menu from \"../../../components/generic/Menu\";\nimport { CONFIG } from \"../../../config/index\";\nimport { isNotUserValid } from \"../../../services/generic\";\nimport Header from \"../../../components/generic/Header\";\nimport ListLeaves from \"../../../components/leave/manageLeaves/ListLeaves\";\nimport ViewLeave from \"../../../modules/leave/components/manageLeaves/ViewLeave\";\nimport LeaveColorReference from \"../../../components/leave/manageLeaves/LeaveColorReference\";\nimport * as actions from \"../../../redux/actions\";\nimport * as actions_listLeaves from \"../../../redux/leave/actions/listLeaves\";\nimport * as actions_manageLeave from \"../../../redux/leave/actions/manageLeave\";\n\nvar ManageLeaves =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ManageLeaves, _React$Component);\n\n  function ManageLeaves(props) {\n    var _this;\n\n    _classCallCheck(this, ManageLeaves);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ManageLeaves).call(this, props));\n\n    _this.props.onIsAlreadyLogin();\n\n    _this.state = {\n      loading: true,\n      selectedTab: \"\",\n      leaveListItems: [],\n      all_leaves: [],\n      selectedLeave: {}\n    };\n    _this.doLeaveStatusChange = _this.doLeaveStatusChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.filterLeaveList = _this.filterLeaveList.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.selectLeave = _this.selectLeave.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(ManageLeaves, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.props.onListLeaves(this.props.loggedUser.data.role);\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(props) {\n      var _this2 = this;\n\n      var selectedTab = \"\";\n      var location = props.location,\n          loggedUser = props.loggedUser;\n      var isNotValid = isNotUserValid(location.pathname, loggedUser);\n\n      if (isNotValid.status) {\n        this.props.history.push(isNotValid.redirectTo);\n      }\n\n      if (props.loggedUser.data.role === CONFIG.ADMIN || props.loggedUser.data.role === CONFIG.GUEST) {\n        // selectedTab = 'ApprovedByHr';\n        selectedTab = \"PendingAdmin\";\n      } else if (props.loggedUser.data.role === CONFIG.HR) {\n        selectedTab = \"Pending\";\n      }\n\n      if (!_.isEqual(props.listLeaves.all_leaves, this.state.all_leaves)) {\n        var tab = localStorage.getItem(\"activeTab\");\n\n        if (!_.isEmpty(tab)) {\n          selectedTab = tab;\n        }\n\n        this.setState({\n          all_leaves: props.listLeaves.all_leaves,\n          selectedTab: selectedTab\n        }, function () {\n          _this2.filterLeaveList(selectedTab);\n        });\n      }\n    }\n  }, {\n    key: \"doLeaveStatusChange\",\n    value: function doLeaveStatusChange(id, newstatus, messagetouser) {\n      this.props.onChangeLeaveStatus(id, newstatus, messagetouser);\n    }\n  }, {\n    key: \"selectLeave\",\n    value: function selectLeave(leaveId) {\n      if (leaveId !== this.state.selectedLeave.id) {\n        var select = _.find(this.state.leaveListItems, {\n          id: leaveId\n        });\n\n        this.setState({\n          selectedLeave: select\n        });\n      }\n    }\n  }, {\n    key: \"filterLeaveList\",\n    value: function filterLeaveList(activeTab) {\n      var all_leaves = this.state.all_leaves;\n      var newLeavesList;\n\n      if (activeTab === \"Pending\") {\n        newLeavesList = _.filter(all_leaves, function (o) {\n          return o.status === \"Pending\" && parseInt(o.hr_approved) === 0;\n        });\n      } else if (activeTab === \"ApprovedByHr\") {\n        newLeavesList = _.filter(all_leaves, function (o) {\n          return o.status === \"Pending\" && parseInt(o.hr_approved) === 1;\n        });\n      } else if (activeTab === \"PendingAdmin\") {\n        newLeavesList = _.filter(all_leaves, function (o) {\n          return o.status === \"Pending\" && (parseInt(o.hr_approved) === 2 || parseInt(o.hr_approved) === 0);\n        });\n      } else {\n        newLeavesList = _.filter(all_leaves, {\n          status: activeTab\n        });\n      }\n\n      var selectedLeave = newLeavesList[0] || {};\n\n      if (!_.isEmpty(this.state.selectedLeave)) {\n        var select = _.filter(newLeavesList, {\n          id: this.state.selectedLeave.id\n        });\n\n        if (_.size(select) > 0) {\n          selectedLeave = select[0];\n        }\n      }\n\n      this.setState({\n        loading: false,\n        leaveListItems: newLeavesList,\n        selectedLeave: selectedLeave,\n        selectedTab: activeTab\n      });\n      localStorage.setItem(\"activeTab\", activeTab);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var styles = _.cloneDeep(this.constructor.styles);\n\n      var status_message = \"\";\n\n      if (this.props.manageLeave.status_message !== \"\") {\n        status_message = React.createElement(\"span\", {\n          className: \"label label-lg primary pos-rlt m-r-xs\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121\n          },\n          __self: this\n        }, React.createElement(\"b\", {\n          className: \"arrow left b-primary\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        }), this.props.manageLeave.status_message);\n      }\n\n      var tabContent;\n\n      if (!this.state.loading && (_.isEmpty(this.state.selectedLeave) || _.isEmpty(this.state.leaveListItems))) {\n        tabContent = React.createElement(\"div\", {\n          className: \"row-col row-col-xs b-b\",\n          id: \"no_manage_leave\",\n          style: styles.spinContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 135\n          },\n          __self: this\n        }, React.createElement(\"span\", {\n          className: \"\",\n          style: styles.spiner,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140\n          },\n          __self: this\n        }, \"No data found\"));\n      } else if (!this.state.loading && !_.isEmpty(this.state.selectedLeave) && !_.isEmpty(this.state.leaveListItems)) {\n        tabContent = React.createElement(\"div\", {\n          className: \"row no-gutter b-b\",\n          id: \"manage_leave_data\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 151\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"col-xs-12 col-sm-3 box b-r\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }, React.createElement(ListLeaves, Object.assign({\n          listItems: this.state.leaveListItems,\n          selectedLeave: this.state.selectedLeave,\n          selectLeave: this.selectLeave\n        }, this.props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }))), React.createElement(\"div\", {\n          id: \"leaveDetails\",\n          className: \"col-xs-12 col-sm-9 light bg b-r\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        }, React.createElement(ViewLeave, Object.assign({\n          selectedLeave: this.state.selectedLeave,\n          doLeaveStatusChange: this.doLeaveStatusChange\n        }, this.props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161\n          },\n          __self: this\n        }))));\n      } else if (this.state.loading) {\n        tabContent = React.createElement(\"div\", {\n          className: \"row-col row-col-xs b-b\",\n          style: styles.spinContainer,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, React.createElement(\"i\", {\n          className: \"fa fa-spinner fa-pulse fa-3x\",\n          style: styles.spiner,\n          \"aria-hidden\": \"true\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        }));\n      }\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, React.createElement(Menu, Object.assign({}, this.props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        id: \"content\",\n        className: \"app-content box-shadow-z0\",\n        role: \"main\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(Header, {\n        pageTitle: \"Manage Leaves\" + status_message,\n        showLoading: this.props.frontend.show_loading,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"app-body\",\n        id: \"view\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"padding\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }, React.createElement(LeaveColorReference, {\n        filterLeaveList: this.filterLeaveList,\n        selectedTab: this.state.selectedTab,\n        userRole: this.props.loggedUser.data.role,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }))), tabContent))));\n    }\n  }]);\n\n  return ManageLeaves;\n}(React.Component);\n\nManageLeaves.styles = {\n  spinContainer: {\n    textAlign: \"center\",\n    fontSize: \"50px\",\n    color: \"#808080\"\n  },\n  spiner: {\n    margin: \"50px auto\"\n  }\n};\n\nfunction mapStateToProps(state) {\n  return {\n    frontend: state.frontend.toJS(),\n    loggedUser: state.logged_user.userLogin,\n    listLeaves: state.listLeaves.toJS(),\n    manageLeave: state.manageLeave.toJS()\n  };\n}\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    onIsAlreadyLogin: function onIsAlreadyLogin() {\n      return dispatch(actions.isAlreadyLogin());\n    },\n    onListLeaves: function onListLeaves(role) {\n      return dispatch(actions_listLeaves.getAllLeaves(role));\n    },\n    onAddDescription: function onAddDescription(leaveid, hr, data) {\n      return dispatch(actions_manageLeave.onAddDescription(leaveid, hr, data));\n    },\n    onAddExtraDay: function onAddExtraDay(leaveid, token, data) {\n      return dispatch(actions_manageLeave.onAddExtraDay(leaveid, token, data));\n    },\n    onChangeLeaveStatus: function onChangeLeaveStatus(leaveid, newstatus, messagetouser) {\n      return dispatch(actions_manageLeave.changeLeaveStatus(leaveid, newstatus, messagetouser));\n    },\n    onDocRequired: function onDocRequired(leaveid, data, comment) {\n      return dispatch(actions_manageLeave.docRequired(leaveid, data, comment));\n    },\n    leaveRevertRequest: function leaveRevertRequest(leaveid, token) {\n      return dispatch(actions_manageLeave.leaveRevertRequest(leaveid, token));\n    }\n  };\n};\n\nvar VisibleManageLeaves = connect(mapStateToProps, mapDispatchToProps)(ManageLeaves);\nvar RouterVisibleManageLeaves = withRouter(VisibleManageLeaves);\nexport default RouterVisibleManageLeaves;","map":{"version":3,"sources":["/var/www/html/ReactReduxHR/frontend/src/modules/leave/containers/manageLeaves.jsx"],"names":["React","connect","withRouter","_","Menu","CONFIG","isNotUserValid","Header","ListLeaves","ViewLeave","LeaveColorReference","actions","actions_listLeaves","actions_manageLeave","ManageLeaves","props","onIsAlreadyLogin","state","loading","selectedTab","leaveListItems","all_leaves","selectedLeave","doLeaveStatusChange","bind","filterLeaveList","selectLeave","onListLeaves","loggedUser","data","role","location","isNotValid","pathname","status","history","push","redirectTo","ADMIN","GUEST","HR","isEqual","listLeaves","tab","localStorage","getItem","isEmpty","setState","id","newstatus","messagetouser","onChangeLeaveStatus","leaveId","select","find","activeTab","newLeavesList","filter","o","parseInt","hr_approved","size","setItem","styles","cloneDeep","constructor","status_message","manageLeave","tabContent","spinContainer","spiner","frontend","show_loading","Component","textAlign","fontSize","color","margin","mapStateToProps","toJS","logged_user","userLogin","mapDispatchToProps","dispatch","isAlreadyLogin","getAllLeaves","onAddDescription","leaveid","hr","onAddExtraDay","token","changeLeaveStatus","onDocRequired","comment","docRequired","leaveRevertRequest","VisibleManageLeaves","RouterVisibleManageLeaves"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { connect } from \"react-redux\";\nimport { withRouter } from \"react-router\";\nimport * as _ from \"lodash\";\nimport Menu from \"../../../components/generic/Menu\";\nimport { CONFIG } from \"../../../config/index\";\nimport { isNotUserValid } from \"../../../services/generic\";\nimport Header from \"../../../components/generic/Header\";\nimport ListLeaves from \"../../../components/leave/manageLeaves/ListLeaves\";\nimport ViewLeave from \"../../../modules/leave/components/manageLeaves/ViewLeave\";\nimport LeaveColorReference from \"../../../components/leave/manageLeaves/LeaveColorReference\";\nimport * as actions from \"../../../redux/actions\";\nimport * as actions_listLeaves from \"../../../redux/leave/actions/listLeaves\";\nimport * as actions_manageLeave from \"../../../redux/leave/actions/manageLeave\";\n\nclass ManageLeaves extends React.Component {\n  constructor(props) {\n    super(props);\n    this.props.onIsAlreadyLogin();\n    this.state = {\n      loading: true,\n      selectedTab: \"\",\n      leaveListItems: [],\n      all_leaves: [],\n      selectedLeave: {}\n    };\n    this.doLeaveStatusChange = this.doLeaveStatusChange.bind(this);\n    this.filterLeaveList = this.filterLeaveList.bind(this);\n    this.selectLeave = this.selectLeave.bind(this);\n  }\n  componentWillMount() {\n    this.props.onListLeaves(this.props.loggedUser.data.role);\n  }\n  componentWillReceiveProps(props) {\n    let selectedTab = \"\";\n    let { location, loggedUser } = props;\n    let isNotValid = isNotUserValid(location.pathname, loggedUser);\n    if (isNotValid.status) {\n      this.props.history.push(isNotValid.redirectTo);\n    }\n    if (\n      props.loggedUser.data.role === CONFIG.ADMIN ||\n      props.loggedUser.data.role === CONFIG.GUEST\n    ) {\n      // selectedTab = 'ApprovedByHr';\n      selectedTab = \"PendingAdmin\";\n    } else if (props.loggedUser.data.role === CONFIG.HR) {\n      selectedTab = \"Pending\";\n    }\n    if (!_.isEqual(props.listLeaves.all_leaves, this.state.all_leaves)) {\n      let tab = localStorage.getItem(\"activeTab\");\n      if (!_.isEmpty(tab)) {\n        selectedTab = tab;\n      }\n      this.setState(\n        {\n          all_leaves: props.listLeaves.all_leaves,\n          selectedTab: selectedTab\n        },\n        () => {\n          this.filterLeaveList(selectedTab);\n        }\n      );\n    }\n  }\n  doLeaveStatusChange(id, newstatus, messagetouser) {\n    this.props.onChangeLeaveStatus(id, newstatus, messagetouser);\n  }\n  selectLeave(leaveId) {\n    if (leaveId !== this.state.selectedLeave.id) {\n      var select = _.find(this.state.leaveListItems, { id: leaveId });\n      this.setState({\n        selectedLeave: select\n      });\n    }\n  }\n\n  filterLeaveList(activeTab) {\n    var all_leaves = this.state.all_leaves;\n    let newLeavesList;\n    if (activeTab === \"Pending\") {\n      newLeavesList = _.filter(all_leaves, function(o) {\n        return o.status === \"Pending\" && parseInt(o.hr_approved) === 0;\n      });\n    } else if (activeTab === \"ApprovedByHr\") {\n      newLeavesList = _.filter(all_leaves, function(o) {\n        return o.status === \"Pending\" && parseInt(o.hr_approved) === 1;\n      });\n    } else if (activeTab === \"PendingAdmin\") {\n      newLeavesList = _.filter(all_leaves, function(o) {\n        return (\n          o.status === \"Pending\" &&\n          (parseInt(o.hr_approved) === 2 || parseInt(o.hr_approved) === 0)\n        );\n      });\n    } else {\n      newLeavesList = _.filter(all_leaves, { status: activeTab });\n    }\n\n    var selectedLeave = newLeavesList[0] || {};\n    if (!_.isEmpty(this.state.selectedLeave)) {\n      var select = _.filter(newLeavesList, { id: this.state.selectedLeave.id });\n      if (_.size(select) > 0) {\n        selectedLeave = select[0];\n      }\n    }\n\n    this.setState({\n      loading: false,\n      leaveListItems: newLeavesList,\n      selectedLeave: selectedLeave,\n      selectedTab: activeTab\n    });\n    localStorage.setItem(\"activeTab\", activeTab);\n  }\n  render() {\n    let styles = _.cloneDeep(this.constructor.styles);\n    let status_message = \"\";\n    if (this.props.manageLeave.status_message !== \"\") {\n      status_message = (\n        <span className=\"label label-lg primary pos-rlt m-r-xs\">\n          <b className=\"arrow left b-primary\" />\n          {this.props.manageLeave.status_message}\n        </span>\n      );\n    }\n\n    let tabContent;\n    if (\n      !this.state.loading &&\n      (_.isEmpty(this.state.selectedLeave) ||\n        _.isEmpty(this.state.leaveListItems))\n    ) {\n      tabContent = (\n        <div\n          className=\"row-col row-col-xs b-b\"\n          id=\"no_manage_leave\"\n          style={styles.spinContainer}\n        >\n          <span className=\"\" style={styles.spiner}>\n            No data found\n          </span>\n        </div>\n      );\n    } else if (\n      !this.state.loading &&\n      (!_.isEmpty(this.state.selectedLeave) &&\n        !_.isEmpty(this.state.leaveListItems))\n    ) {\n      tabContent = (\n        <div className=\"row no-gutter b-b\" id=\"manage_leave_data\">\n          <div className=\"col-xs-12 col-sm-3 box b-r\">\n            <ListLeaves\n              listItems={this.state.leaveListItems}\n              selectedLeave={this.state.selectedLeave}\n              selectLeave={this.selectLeave}\n              {...this.props}\n            />\n          </div>\n          <div id=\"leaveDetails\" className=\"col-xs-12 col-sm-9 light bg b-r\">\n            <ViewLeave\n              selectedLeave={this.state.selectedLeave}\n              doLeaveStatusChange={this.doLeaveStatusChange}\n              {...this.props} \n            />\n          </div>\n        </div>\n      );\n    } else if (this.state.loading) {\n      tabContent = (\n        <div className=\"row-col row-col-xs b-b\" style={styles.spinContainer}>\n          <i\n            className=\"fa fa-spinner fa-pulse fa-3x\"\n            style={styles.spiner}\n            aria-hidden=\"true\"\n          />\n        </div>\n      );\n    }\n    return (\n      <div>\n        <Menu {...this.props} />\n        <div id=\"content\" className=\"app-content box-shadow-z0\" role=\"main\">\n          <Header\n            pageTitle={\"Manage Leaves\" + status_message}\n            showLoading={this.props.frontend.show_loading}\n          />\n          <div className=\"app-body\" id=\"view\">\n            <div className=\"padding\">\n              <div className=\"row\">\n                <div className=\"col-12\">\n                  <LeaveColorReference\n                    filterLeaveList={this.filterLeaveList}\n                    selectedTab={this.state.selectedTab}\n                    userRole={this.props.loggedUser.data.role}\n                  />\n                </div>\n              </div>\n              {tabContent}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nManageLeaves.styles = {\n  spinContainer: {\n    textAlign: \"center\",\n    fontSize: \"50px\",\n    color: \"#808080\"\n  },\n  spiner: {\n    margin: \"50px auto\"\n  }\n};\nfunction mapStateToProps(state) {\n  return {\n    frontend: state.frontend.toJS(),\n    loggedUser: state.logged_user.userLogin,\n    listLeaves: state.listLeaves.toJS(),\n    manageLeave: state.manageLeave.toJS()\n  };\n}\nconst mapDispatchToProps = dispatch => {\n  return {\n    onIsAlreadyLogin: () => {\n      return dispatch(actions.isAlreadyLogin());\n    },\n    onListLeaves: role => {\n      return dispatch(actions_listLeaves.getAllLeaves(role));\n    },\n    onAddDescription: (leaveid, hr, data) => {\n      return dispatch(actions_manageLeave.onAddDescription(leaveid, hr, data));\n    },\n    onAddExtraDay: (leaveid, token, data) => {\n      return dispatch(actions_manageLeave.onAddExtraDay(leaveid, token, data));\n    },\n    onChangeLeaveStatus: (leaveid, newstatus, messagetouser) => {\n      return dispatch(\n        actions_manageLeave.changeLeaveStatus(leaveid, newstatus, messagetouser)\n      );\n    },\n    onDocRequired: (leaveid, data, comment) => {\n      return dispatch(actions_manageLeave.docRequired(leaveid, data, comment));\n    },\n    leaveRevertRequest: (leaveid, token)=> dispatch(actions_manageLeave.leaveRevertRequest(leaveid, token))\n  };\n};\n\nconst VisibleManageLeaves = connect(mapStateToProps, mapDispatchToProps)(\n  ManageLeaves\n);\n\nconst RouterVisibleManageLeaves = withRouter(VisibleManageLeaves);\n\nexport default RouterVisibleManageLeaves;\n"]},"metadata":{},"sourceType":"module"}